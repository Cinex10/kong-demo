# {{ project_name }} Kong API Gateway Demo

This repository contains a pre-configured Kong API Gateway setup for demonstration purposes.

## Overview

This demo includes:

- Kong API Gateway with built-in Admin UI (Kong Manager)
- PostgreSQL database for Kong
- {% for service in config.services %}{{ service.name }}{% if not loop.last %}, {% endif %}{% endfor %} mock services with realistic endpoints

## Getting Started

### Prerequisites

- Docker and Docker Compose
- curl (for testing)

### Setup Instructions

1. Start the Kong demo environment:

```bash
./setup.sh
```

2. Access the Kong Admin API at http://localhost:8001
3. Access Kong Manager UI at http://localhost:8002

## Mock API Services

Each mock API service provides the following endpoints:

- `/health` - Returns health status of the service
- `/info` - Returns information about the service
- `/echo` - Echoes back the request details (method, headers, body, etc.)
- `/items` - A CRUD REST API for demo purposes (supports GET, POST, PUT, DELETE)

## API Routes

The following API routes have been configured:

{% for route in config.routes %}
- `{{ route.paths[0] }}` - Routes to `{{ route.service_name }}` service
{% endfor %}

## Authentication

{% set auth_plugin = none %}
{% for plugin in config.plugins %}
{% if plugin.name in ['key-auth', 'jwt', 'oauth2', 'basic-auth'] %}
{% set auth_plugin = plugin %}
{% endif %}
{% endfor %}

{% if auth_plugin %}
This demo uses {{ auth_plugin.name }} authentication.

{% if auth_plugin.name == 'key-auth' %}
Example request:
```bash
curl -i -X GET http://localhost:8000{{ config.routes[0].paths[0] }} \
  -H "apikey: demo-key-{{ config.consumers[0].username }}"
```
{% endif %}
{% else %}
This demo does not use authentication.

Example request:
```bash
curl -i -X GET http://localhost:8000{{ config.routes[0].paths[0] }}
```
{% endif %}

## Plugins Enabled

{% for plugin in config.plugins %}
- {{ plugin.name }}
{% endfor %}

## Testing the API

Run the test script to check all configured routes:

```bash
./test-api.sh
```

## Modifying the Mock APIs

If you need to modify the mock API behavior:

1. Edit the code in `mock-apis/[service-name]/server.js`
2. Rebuild and restart the containers:
```bash
docker-compose down
docker-compose up -d
```

## Cleanup

To stop and remove all containers:

```bash
docker-compose down -v
```
